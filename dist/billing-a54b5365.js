(window.webpackJsonpCheckout=window.webpackJsonpCheckout||[]).push([[4],{1177:function(e,t,n){"use strict";n.r(t);var r,o=n(6),i=n(0),a=n.n(i),s=n(1167),u=n(1061),c=n(426),l=n(1016),d=n(1011),p=n(1071),f=n(1020),h=n(1013),g=n(85),b=n(58),m=n(1168),y=n(1169),v=n(1175),w=n(420),A=n(419),O=n(224),C=n(1170),S=n(1012),k=n(1018),j=n(1019),E=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_=function(){return(_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},P=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},F=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isResettingAddress:!1},t.addressFormRef=Object(i.createRef)(),t.handleSelectAddress=function(e){return P(t,void 0,void 0,function(){var t,n,r,o;return F(this,function(i){switch(i.label){case 0:t=this.props,n=t.updateAddress,r=t.onUnhandledError,this.setState({isResettingAddress:!0}),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,n(e)];case 2:return i.sent(),[3,5];case 3:return o=i.sent(),r(o),[3,5];case 4:return this.setState({isResettingAddress:!1}),[7];case 5:return[2]}})})},t.handleUseNewAddress=function(){t.handleSelectAddress({})},t}return E(t,e),t.prototype.render=function(){var e=this.props,t=e.googleMapsApiKey,n=e.billingAddress,r=e.countriesWithAutocomplete,o=e.customer.addresses,i=e.getFields,s=e.countries,u=e.isUpdating,c=e.setFieldValue,l=e.shouldShowOrderComments,p=e.values,f=this.state.isResettingAddress,g=o&&o.length>0,b=n&&Object(m.a)(n,o,i(n.countryCode));return a.a.createElement(k.a,{autoComplete:"on"},a.a.createElement(j.a,{ref:this.addressFormRef,id:"checkoutBillingAddress"},g&&a.a.createElement(j.a,{id:"billingAddresses"},a.a.createElement(h.a,{isLoading:f},a.a.createElement(y.a,{addresses:o,selectedAddress:b?n:void 0,onUseNewAddress:this.handleUseNewAddress,onSelectAddress:this.handleSelectAddress}))),!b&&a.a.createElement(h.a,{isLoading:f},a.a.createElement(v.a,{countries:s,countriesWithAutocomplete:r,setFieldValue:c,googleMapsApiKey:t,countryCode:p.countryCode,formFields:i(p.countryCode)}))),l&&a.a.createElement(C.a,null),a.a.createElement("div",{className:"form-actions"},a.a.createElement(S.c,{variant:S.b.Primary,isLoading:u||f,disabled:u||f,id:"checkout-billing-continue",type:"submit"},a.a.createElement(d.a,{id:"common.continue_action"}))))},t}(i.PureComponent),U=Object(O.a)(Object(g.g)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,n=e.customerMessage,r=e.billingAddress;return _({},Object(w.a)(t(r&&r.countryCode),r),{orderComment:n})},isInitialValid:function(e){var t=e.billingAddress,n=e.getFields,r=e.language;return!!t&&Object(A.a)({language:r,formFields:n(t.countryCode)}).isValidSync(t)},validationSchema:function(e){var t=e.language,n=e.getFields;return Object(b.lazy)(function(e){return Object(A.a)({language:t,formFields:n(e&&e.countryCode)})})},enableReinitialize:!0})(x)),M=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},R=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},N=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},z=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return R(t,void 0,void 0,function(){var t,n,r,o,i,a,c,l,d,p,f=e.orderComment,h=z(e,["orderComment"]);return N(this,function(e){switch(e.label){case 0:t=this.props,n=t.updateAddress,r=t.updateCheckout,o=t.customerMessage,i=t.billingAddress,a=t.navigateNextStep,c=t.onUnhandledError,l=[],(d=Object(s.a)(h))&&!Object(u.a)(d,i)&&l.push(n(d)),o!==f&&l.push(r({customerMessage:f})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(l)];case 2:return e.sent(),a(),[3,4];case 3:return p=e.sent(),c(p),[3,4];case 4:return[2]}})})},t}return M(t,e),t.prototype.componentDidMount=function(){return R(this,void 0,Promise,function(){var e,t,n,r,i,a;return N(this,function(s){switch(s.label){case 0:e=this.props,t=e.initialize,n=e.onReady,r=void 0===n?o.noop:n,i=e.onUnhandledError,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,t()];case 2:return s.sent(),r(),[3,4];case 3:return a=s.sent(),i(a),[3,4];case 4:return[2]}})})},t.prototype.render=function(){var e=this.props,t=e.updateAddress,n=e.isInitializing,r=z(e,["updateAddress","isInitializing"]);return a.a.createElement("div",{className:"checkout-form"},a.a.createElement("div",{className:"form-legend-container"},a.a.createElement(f.a,{testId:"billing-address-heading"},a.a.createElement(d.a,{id:"billing.billing_address_heading"}))),a.a.createElement(h.a,{unmountContentWhenLoading:!0,isLoading:n},a.a.createElement(U,B({},r,{updateAddress:t,onSubmit:this.handleSubmit}))))},t}(i.Component);t.default=Object(c.a)(function(e){var t=e.checkoutService,n=e.checkoutState,r=n.data,o=r.getCheckout,i=r.getConfig,a=r.getCart,s=r.getCustomer,u=r.getBillingAddress,c=r.getBillingAddressFields,d=r.getBillingCountries,f=n.statuses,h=f.isLoadingBillingCountries,g=f.isUpdatingBillingAddress,b=f.isUpdatingCheckout,m=i(),y=s(),v=o(),w=a();if(!(m&&y&&v&&w))return null;var A=m.checkoutSettings,O=A.enableOrderComments,C=A.googleMapsApiKey,S=["US","CA","AU","NZ"];return A.features["CHECKOUT-4183.checkout_google_address_autocomplete_uk"]&&S.push("GB"),{billingAddress:u(),countries:d()||l.a,countriesWithAutocomplete:S,customer:y,customerMessage:v.customerMessage,getFields:c,googleMapsApiKey:C,initialize:t.loadBillingAddressFields,isInitializing:h(),isUpdating:g()||b(),shouldShowOrderComments:O&&Object(p.a)(w)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout}})(I)}}]);
//# sourceMappingURL=billing-a54b5365.js.map